from django.core.management.base import BaseCommand, CommandError
from dilipadsite.models import *
import lxml.html as lh
import urllib2
import datetime

############## broken and not useful; may be incorporated later

class Command(BaseCommand):
    help = "Retroactively assigns parlinfo IDs to this current parliament"

    def handle(self, *args, **options):

        memberDict={'10060':'06641ef6-4768-4031-a720-ce0ae303c3c5',
        '9366':'ea3bdfb2-c01b-4b31-937f-51fafc045172',
        '9364':'28d83c5f-3291-48a5-844c-0cc8b786fb15',
        '10296':'bbf2ffbd-6780-4792-8a0a-fae1bd72a6c4',
        '10214':'3106c3be-f49e-4c55-9d12-fb6441875251',
        '10348':'f82c2265-7622-4abb-b866-59cba1fa52ee',
        '9671':'3b9aadd7-086c-4788-8f4e-bbb6cc46f2c9',
        '9622':'3378437f-1669-4fcb-9c2e-0c7c12626a1e',
        '9775':'16650588-6dad-4651-892b-32a2bbca8a4f',
        '10459':'4437c848-d8c7-4a39-a948-1539969f3a90',
        '10340':'75d4be3f-f1cf-499d-882b-6415247900e6',
        '9678':'6e685d19-e124-452d-b395-5deedc595b4c',
        '9770':'350c31fd-6260-4c63-bd17-0746cb6f4120',
        '10345':'9e05a099-6a0b-4fe2-9e9b-0a8b91b7807b',
        '9703':'811a7b9a-4be5-4f9a-a302-088cb204bfba',
        '9289':'634edc34-ea0d-406f-ade1-eeec6c5bad04',
        '10309':'0ac173b3-8d7f-40ce-a34c-aabda1c5b54e',
        '10182':'172813a0-1268-4f8b-9e5d-2e35761bef30',
        '9285':'2c7cfe15-cb1e-43c5-831d-6ad09d4a16b6',
        '10410':'fa63df53-0ecd-4f55-97bb-ac3e8d408e25',
        '9281':'55c46957-54e9-422a-8afd-7c709bcf16a0',
        '9834':'62980ec3-d32c-446e-877f-9dc274de8b70',
        '9835':'18e36567-4082-4ce3-a35b-d4aba65560ca',
        '10581':'dfce868a-f590-4d20-b1b6-4e08a3e5b669',
        '9564':'0f7e3c8d-e579-44c0-b8b7-202b425758e4',
        '9568':'16ec30ba-16f2-4777-ab8d-db372238e239',
        '9683':'3ff14d0c-dab2-4712-b042-b1ba2da6728f',
        '8655':'f60ef5d8-8e71-4953-bc1b-a8ea4749a18e',
        '10068':'002b9ee7-5ecd-4727-96bb-ca4d1e06766d',
        '9935':'88b0859f-5d9c-4b99-96aa-e9c0dca31463',
        '9271':'7ee20ab9-2d43-420c-8027-f6403cb498a2',
        '10523':'2d98e2df-3246-4a59-8048-8be83adb2c42',
        '10351':'03fec1f2-5bf7-4f22-8a1f-0a48e4b70a4e',
        '9276':'f8ea336f-74b1-413f-a222-1943aef1b58d',
        '10055':'363e30d6-e47b-4c39-91ad-667deb63009c',
        '10053':'fa57da4d-d6e1-44ed-9449-b5b1f6361a5c',
        '10359':'e63101b2-e7b2-4890-9b4c-be9cf366866f',
        '10050':'858770e9-c9c2-4a95-a6e4-679c973912fd',
        '9709':'d2579078-20cf-47e6-bac4-d8796415f92e',
        '10204':'030c04f1-a5d5-4ba8-b5f2-cd412d43e4bf',
        '9664':'deea27ee-c7f2-4442-99ac-2417bbea8359',
        '9820':'e4445566-ac85-47e6-8583-a705a8c2d0fa',
        '10201':'5d3dfa7b-f157-4019-ac2a-4dab0cb15f92',
        '10117':'69e429cb-3bd3-4744-95a0-701e3b95c115',
        '9984':'5848c1f7-b3d9-4dd3-af1c-019e0a321f7a',
        '10447':'711a47d7-2f48-4673-a4b1-a79126bd8e85',
        '9707':'b0010e40-d2c6-4a8e-a518-447721affc15',
        '8871':'3a81a21a-bec2-40b4-aae5-d554237ba474',
        '10194':'34585e7d-930f-472a-a618-495ca92cd6a9',
        '9908':'a7648c3d-c78b-4848-bf55-ef56438c1f25',
        '9572':'d337fa82-07cb-4116-aa1f-1ec090e1ef4c',
        '10450':'e38f0ee9-418f-4b86-a6fd-2c859c05d475',
        '9263':'3b00808c-6ef4-44a2-8204-dc48574a870e',
        '10531':'04ef6f9c-3039-4fb0-a1ad-82a6ba2f03bf',
        '10533':'88ce81f3-c8b1-4ab9-bbdb-aa677d83b394',
        '10040':'4626b9b7-420c-456d-9c7b-dea3794cb1c5',
        '10380':'cee27afa-cdf8-4e99-ab22-22290f86aa3a',
        '10044':'d8c0f53f-e93f-422e-866c-48645e49671b',
        '9999':'83cd3ab5-7dc7-414e-ab8b-e0dbc16b4c4a',
        '9656':'b793930e-6fb6-449d-bc33-1c9575def1a9',
        '9855':'4b18a0b6-bb17-4967-84ef-abb5a4dde893',
        '9713':'ffeab63b-041e-4d87-bdad-1b79ff9a98c5',
        '9306':'e1f28a5b-c4f6-453e-8d78-f346683e1fb8',
        '10238':'57c5c196-1fdc-474f-8549-ed83eadb791f',
        '9717':'3e3ce514-a196-4878-ad0f-a2bf0772cdfd',
        '10510':'c049fb93-b7d8-4021-8fc6-cf1c69f7200b',
        '9497':'8138ca16-415e-431d-9d95-051874ca6e3d',
        '9380':'c80fcb28-a347-4594-9e11-63ac3c37e428',
        '9382':'c4b4aef5-eca1-416d-b2b0-ad4a1a2b5fc9',
        '9918':'7a2a1996-59b6-46e8-8ed0-9ea3c0fcf4ad',
        '799':'7f01c656-5f94-4743-9018-ad3a89bb2fc4',
        '10551':'9ad0ff66-1598-45e6-b146-6dd0eefb9cd0',
        '9781':'500229ce-460b-45f9-93ce-abf974f9787d',
        '9466':'7bb531cc-945d-41fb-bd88-3e7bdfefa350',
        '9460':'530dc476-c9bf-477c-83e7-6efc545f2bf8',
        '9549':'ea197684-00f6-458f-a46b-5bea7db6f7f3',
        '9788':'f2313477-3104-468f-9384-a371bedc7d09',
        '9547':'24b3616f-1e8d-4fd3-9420-0a3d7ab8b6d3',
        '10256':'6f563895-ecb5-41c5-bcec-9c45d63bed5c',
        '9542':'cd2b5c50-ef21-4dce-af6d-ed530bdb5837',
        '9726':'f8911e4d-f080-4ac8-94b1-74a18979c811',
        '9313':'3ee3ccd6-802d-454e-9dcf-61a7a017bdf7',
        '10131':'b6e2c8aa-fc83-4d52-ad66-7910b8805f90',
        '9258':'33ef2052-c37d-446f-9d03-515d01591eba',
        '10335':'3c3175ff-595b-4f50-a58d-b41cd7b5b100',
        '10139':'2490b23e-4439-4513-9d54-6fceb6320267',
        '10497':'61edc25f-3448-46fd-9632-6c5c23fd98a6',
        '9840':'ae40e780-7dd1-4e34-bf90-4dbb35c18443',
        '10228':'e3cf1c1d-8785-480a-840e-d22557b891d7',
        '9318':'e7d4b944-1d3e-4f87-a7df-cdbd4fe7ca2b',
        '9315':'99ee0962-1c47-4653-9b76-6a90e16f4604',
        '9848':'f1ca301b-cd67-48b5-9dd4-0f6c2af5454e',
        '9487':'b480ca59-cff5-4fed-b0ab-a833f923ef98',
        '6424':'e39c6a4d-cac9-4e3e-b8d5-528f15a76519',
        '903':'04c68597-7211-414e-b0f0-da12d212bd3f',
        '8728':'b69886d7-ac34-44bd-ab73-bac915667dd6',
        '9791':'ab30a165-2ce2-4465-af10-19ae0fc1aec0',
        '9415':'eda66e22-490c-4221-b4a0-4eaedacd34e1',
        '9417':'79ed56c5-9960-4de7-bf05-9cd4aa51dbf5',
        '9419':'7e23c9e2-cce8-4cd0-b5ed-200a809748cb',
        '9553':'7bf98536-0fc9-439c-8132-7956605466f0',
        '2161':'4c0685b7-4ab9-4321-bb90-a5cb3ae307da',
        '9556':'aaf26c99-85fb-4ea0-aaf2-5e56a16ed7ba',
        '9731':'b4442fcd-62cf-456e-a49b-625ea35069b5',
        '10321':'d4c1a041-62a4-4b0f-be30-27be89cd2bd2',
        '10414':'782dab6a-6e60-4132-992b-4933293f30d4',
        '9539':'d9a6cad1-b3b6-4393-afc5-7c897fb638e6',
        '10146':'131b0f70-8840-4d9a-94ff-fa579a1ef7af',
        '10542':'6322565a-d236-4124-81f3-d869f865f7ef',
        '10301':'775ebcdb-4561-4bd0-8c84-d14531f2c726',
        '10418':'85738a00-0a16-4a6f-89c7-9f045782d1fd',
        '10557':'2f8fed89-2dde-4683-b1f0-03d1f782d96a',
        '10554':'61c83e21-f9a3-4e4b-b881-4b2d1ce33c43',
        '10382':'eed67a03-db05-4376-89b3-8e038fa83728',
        '10029':'ddcc96da-5bcf-4069-9cd6-da8f76df8b89',
        '9630':'2428082e-6784-4ce4-ae08-dab7caa06e6b',
        '10253':'5984fab3-2564-47f9-a49a-ebb07b5cbb24',
        '9875':'d05df46d-aa51-4084-89b7-cb5f95ba0652',
        '9634':'be085f18-2e23-4c31-a950-b5ce11000aa6',
        '9873':'57a5155f-7b78-4fe9-9c6d-c425f053d4b2',
        '9324':'d3ed44bf-a69d-4457-92e3-5e94157c4980',
        '10021':'17da20d7-35e1-4618-8c84-00a00dd88d4f',
        '10426':'b6850f16-57dc-486c-b5bb-0fd191022af4',
        '8822':'e8a82025-8dd3-4301-bccf-653d4b98b18c',
        '10435':'1ad00957-54b5-494d-8773-b530fbe4967b',
        '9400':'a9fb83d8-ba9f-4794-9229-1fb53e7a1a1d',
        '9408':'f3e80d5d-ca86-4d25-bd54-e0f297634469',
        '10153':'726008a1-cf4f-46b2-ad5c-1503f936671b',
        '10150':'dbb0dd7c-287c-4115-9424-4b2c55652877',
        '9332':'64cec702-209d-4f03-bb85-1943f635d077',
        '10312':'60df4944-d66b-4133-a348-2bcde37c8752',
        '9501':'d67a49c2-65bd-411e-8bb4-29ff759c5829',
        '10314':'03134e55-2453-4c19-83a4-c20bbd6e5a3e',
        '10162':'e915cec9-7164-4846-aeb5-d5bf2e4f3598',
        '9869':'da91c83a-bab4-427f-b9e4-973025dbcab0',
        '10562':'343b5c4a-fb8c-4248-8183-5ab683bc9f9f',
        '10248':'c127569a-6bb5-4afe-b64b-401affe669d2',
        '8577':'9fe7bceb-dae2-4f26-b87b-2de1f38b4b84',
        '10567':'a80d5459-3c49-4ef6-bf76-533dac6290b0',
        '9741':'6e88c64b-66df-4989-84da-2a037744909c',
        '10396':'82710269-4171-4303-af2b-f60b55256b3e',
        '10399':'86a43c8a-1145-4984-af24-0fe651826173',
        '10240':'b9c4c914-1880-40a6-9c2a-701c329f27bc',
        '9589':'f45e86b7-f192-4692-9889-6b57283fc3b0',
        '10014':'f37d5cb2-a1ad-4ec9-a7de-ca265da02938',
        '869':'a5da7604-b429-46d1-b702-0e3be1febcec',
        '10439':'0e1edc18-5616-4f5c-b9bd-535059ec8040',
        '9937':'97c88642-336a-4c31-965a-f796eeebc3df',
        '10099':'26a7c39b-6a77-446a-8986-1d3086f156fe',
        '9942':'cb8ec688-1348-4901-abf1-3230bc8d9691',
        '9946':'503863c7-9c0e-4df3-b6b8-5282720270ea',
        '10499':'25300fa4-5a6d-42d6-adc3-849dcf9b02b4',
        '9439':'82887400-c34e-4588-8542-7ad259b14fe8',
        '1515':'1f33985f-5901-4702-b541-1d77f0f88aef',
        '9437':'ee06377a-6024-40ae-9fe4-a059508592a4',
        '8836':'41c4a234-7472-4511-a49a-d09355b4c726',
        '10134':'c5d87175-ce3a-486e-a9b3-827145422791',
        '9430':'9d4edb74-dcdc-4751-8541-6e42405e2bc5',
        '10277':'2b91ab47-7930-4848-ad6e-fde1a50a9569',
        '9341':'e277e13e-59ec-425f-a957-eb5e54d8cb62',
        '9299':'b0e264f1-17db-47ef-ae2c-162a305cf4fa',
        '10273':'cd83ba99-0c5b-4f51-a42b-a73504b91199',
        '9347':'d32cbf2b-5b28-4698-ba39-c1ac2f736c3e',
        '9337':'7ba5ccca-0132-4942-982e-fb0ca43b3ff5',
        '9453':'bd2068aa-74c7-430a-bdf5-6f17b14ca140',
        '10475':'115aadf7-f4d7-4c9d-9537-860cf864ad0c',
        '9490':'8bd1a4d2-ee35-4f33-b21f-79e81c6d3b76',
        '9753':'aa073ec9-d887-4192-a2ff-f3acbd6709b2',
        '10368':'897d99d9-377d-43a8-81be-27a22174136e',
        '10572':'5e126a6d-7b4a-4e53-951f-7f1a7e9b5c0e',
        '9818':'a1ab84bb-cc28-4c72-aa62-fb64d69a6673',
        '9411':'8d76bafe-6072-47e5-8308-42baae84cc00',
        '9300':'b078667f-922f-4979-a4c6-311e7bdc4068',
        '10081':'af4d6069-8435-4361-9a6f-d38c96e9d50a',
        '9812':'113d2f8f-bc0d-4db5-86e8-99f31c86216f',
        '9994':'53435570-da9e-42e1-a195-e5475a2f8b13',
        '8849':'653f32c7-c885-4508-b59f-efef39fe6378',
        '9958':'f3a557f2-05f9-423a-a825-aad43e31e10c',
        '9892':'e321e85f-f1c1-4482-bf16-f640eb41e9f9',
        '9954':'65916721-c92d-4ae1-80e6-2e696b0c5d94',
        '10483':'eb417798-95f7-45a0-b1e9-ca3a6526d4db',
        '9425':'22a6ff7d-fc39-47b2-8003-a016329ed224',
        '9899':'c5b09363-414d-43b2-bc2c-274b997c8989',
        '9600':'2e1280c7-9cb0-4dee-9db6-0a6b0d244592',
        '9603':'fe08cc31-44b1-466e-a0c6-1b0c61c8bf97',
        '10263':'105e8cbe-daea-4eb6-83fe-e5294dc5c844',
        '10075':'48fc6e8f-3117-407b-bba3-bd6eede347ec',
        '9608':'a5384703-9cfa-4420-b899-8c14c919115a',
        '9445':'62c4052f-dd41-418a-9b5b-1715c0baa84d',
        '9985':'68bad047-6aec-43e2-b870-7bc501110873',
        '9649':'831322ab-9fa6-437e-92ba-1b4525f8242d',
        '10463':'8433b4ed-0aa1-4609-bc70-6348fd323a11',
        '10281':'330c0119-cf49-4e85-9407-539367825c2b',
        '10468':'d5585b98-faca-4796-a7ea-a48d007cd58e',
        '9294':'e849cb7a-82f0-49eb-aea4-573c06169a5d',
        '9666':'c58bb7da-2385-4bbf-a8f1-b781f634a80c',
        '9804':'53eb10e4-f8e7-4ef7-9448-b4a10ec1dba3',
        '9802':'fa2cbab8-f429-402f-b603-ea918add87c3',
        '9747':'6ba9d6d4-25fc-4892-bc70-d2c289cf25b1',
        '9511':'09025465-b112-4c9f-8f7c-ed900c423667',
        '9882':'101111c4-d4b7-46a9-9f88-9bfa542bb606',
        '9922':'ff7a7f13-0558-4282-8cfc-9bfdfcbf6a1a',
        '8726':'93d34552-e08f-449a-86bf-d0cac6a69f23',
        '9927':'8942c6f2-bfc8-4275-97bb-a5086a07138e'}

        qs = basehansard.objects.filter(speechdate__gte="2015-10-01").exclude(speakerposition="intervention").exclude(speakerposition="stagedirection").exclude(speakerposition="topic").exclude(speakerposition="subtopic").filter(pid="")
        for obj in qs.iterator():
            try:
                obj.pid = memberDict[obj.opid]
                obj.save()
            except KeyError:
                pass

                
                
            
            
            

